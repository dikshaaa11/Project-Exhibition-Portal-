</div>

    <script>
        // Configuration
        const API_BASE = window.location.origin;
        let currentUser = null;
        let token = null;
        let currentProjectForReject = null;

        // Utility functions
        function showMessage(containerId, message, isError = false) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = `<div class="${isError ? 'error-message' : 'success-message'}">${message}</div>`;
                setTimeout(() => container.innerHTML = '', 5000);
            }
        }

        function showLoading(containerId, show = true) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = show ? '<div class="loading">Loading...</div>' : '';
            }
        }

        function countWords(text) {
            return text.trim().split(/\s+/).filter(word => word.length > 0).length;
        }

        function updateCharCount() {
            const textarea = document.getElementById('projectAbstract');
            const counter = document.getElementById('charCount');
            const wordCount = countWords(textarea.value);
            
            counter.textContent = `${wordCount} / 500 words`;
            
            if (wordCount > 500) {
                counter.classList.add('exceeded');
                textarea.style.borderColor = '#e74c3c';
            } else {
                counter.classList.remove('exceeded');
                textarea.style.borderColor = '#e9ecef';
            }
        }

        function updateRejectCharCount() {
            const textarea = document.getElementById('rejectComment');
            const counter = document.getElementById('rejectCharCount');
            const wordCount = countWords(textarea.value);
            
            counter.textContent = `${wordCount} / 500 words`;
            
            if (wordCount > 500) {
                counter.classList.add('exceeded');
                textarea.style.borderColor = '#e74c3c';
            } else {
                counter.classList.remove('exceeded');
                textarea.style.borderColor = '#e9ecef';
            }
        }

        // API functions
        async function apiCall(endpoint, options = {}) {
            const config = {
                headers: {
                    'Content-Type': 'application/json',
                    ...(token && { 'Authorization': `Bearer ${token}` })
                },
                ...options
            };

            try {
                const response = await fetch(`${API_BASE}${endpoint}`, config);
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'Request failed');
                }
                
                return data;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }

        // Password Modal Functions
        function showPasswordModal() {
            document.getElementById('passwordModal').style.display = 'block';
        }

        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }

        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (!currentPassword || !newPassword || !confirmPassword) {
                showMessage('passwordModalMessage', 'Please fill all fields', true);
                return;
            }

            if (newPassword !== confirmPassword) {
                showMessage('passwordModalMessage', 'New passwords do not match', true);
                return;
            }

            if (newPassword.length < 6) {
                showMessage('passwordModalMessage', 'New password must be at least 6 characters', true);
                return;
            }

            try {
                await apiCall('/api/auth/change-password', {
                    method: 'POST',
                    body: JSON.stringify({ currentPassword, newPassword })
                });

                showMessage('passwordModalMessage', 'Password changed successfully!');
                currentUser.mustChangePassword = false;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                setTimeout(() => {
                    closePasswordModal();
                }, 2000);
            } catch (error) {
                showMessage('passwordModalMessage', error.message, true);
            }
        }

        // Reject Modal Functions
        function showRejectModal(projectId) {
            currentProjectForReject = projectId;
            document.getElementById('rejectModal').style.display = 'block';
        }

        function closeRejectModal() {
            document.getElementById('rejectModal').style.display = 'none';
            document.getElementById('rejectComment').value = '';
            currentProjectForReject = null;
        }

        async function submitRejection() {
            const comment = document.getElementById('rejectComment').value;
            const wordCount = countWords(comment);

            if (!comment.trim()) {
                showMessage('rejectModalMessage', 'Feedback comment is required', true);
                return;
            }

            if (wordCount > 500) {
                showMessage('rejectModalMessage', 'Comment exceeds 500 word limit', true);
                return;
            }

            try {
                await apiCall(`/api/projects/${currentProjectForReject}/reject`, {
                    method: 'POST',
                    body: JSON.stringify({ comment })
                });

                showMessage('rejectModalMessage', 'Project reviewed with feedback');
                setTimeout(() => {
                    closeRejectModal();
                    loadReviewProjects();
                    loadFacultyDashboard();
                }, 2000);
            } catch (error) {
                showMessage('rejectModalMessage', error.message, true);
            }
        }

        // Initialize demo data
        async function initDemo() {
            try {
                showMessage('loginMessage', 'Initializing demo data...');
                await apiCall('/api/init-demo', { method: 'POST' });
                showMessage('loginMessage', 'Demo data initialized successfully!');
            } catch (error) {
                showMessage('loginMessage', error.message, true);
            }
        }

        // Authentication
        async function login() {
            const loginId = document.getElementById('loginId').value;
            const password = document.getElementById('password').value;
            const role = document.querySelector('.role-btn.active').dataset.role;

            if (!loginId || !password) {
                showMessage('loginMessage', 'Please enter login credentials', true);
                return;
            }

            try {
                const response = await apiCall('/api/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ loginId, password })
                });

                if (response.user.role !== role) {
                    showMessage('loginMessage', `Access denied: You are a ${response.user.role}, not a ${role}`, true);
                    return;
                }

                token = response.token;
                currentUser = response.user;
                
                localStorage.setItem('token', token);
                localStorage.setItem('currentUser', JSON.stringify(currentUser));

                document.getElementById('loginSection').classList.add('hidden');

                // Check if password change is required
                if (currentUser.mustChangePassword && role !== 'admin') {
                    showPasswordModal();
                }

                document.getElementById(role + 'Dashboard').classList.remove('hidden');

                if (role === 'student') loadStudentDashboard();
                else if (role === 'faculty') loadFacultyDashboard();
                else if (role === 'admin') loadAdminDashboard();

            } catch (error) {
                showMessage('loginMessage', error.message, true);
            }
        }

        function logout() {
            token = null;
            currentUser = null;
            localStorage.removeItem('token');
            localStorage.removeItem('currentUser');
            location.reload();
        }

        // Student Dashboard
        async function loadStudentDashboard() {
            try {
                const [projects, applications] = await Promise.all([
                    apiCall('/api/projects'),
                    apiCall('/api/applications/my')
                ]);

                const approvedProjects = projects.filter(p => p.status === 'approved');
                
                document.getElementById('studentAppsCount').textContent = applications.length;
                document.getElementById('availableProjectsCount').textContent = approvedProjects.length;

                // Show available projects
                const projectsDiv = document.getElementById('availableProjects');
                if (approvedProjects.length === 0) {
                    projectsDiv.innerHTML = '<p>No approved projects available yet.</p>';
                } else {
                    projectsDiv.innerHTML = '';
                    approvedProjects.forEach(project => {
                        const hasApplied = applications.some(app => app.project._id === project._id);
                        const projectDiv = document.createElement('div');
                        projectDiv.className = 'project-card';
                        projectDiv.innerHTML = `
                            <h4>${project.title}</h4>
                            <p><strong>Faculty:</strong> ${project.faculty.name}</p>
                            <p><strong>Description:</strong> ${project.abstract}</p>
                            <p><strong>Timeline:</strong> ${project.timeline}</p>
                            <p><strong>Seats Available:</strong> ${project.seatsAvailable}/${project.seats}</p>
                            <div style="margin-top: 15px;">
                                ${hasApplied ? 
                                    '<span class="status-badge status-pending">Applied</span>' :
                                    (project.seatsAvailable > 0 ? 
                                        `<button class="btn" onclick="applyToProject('${project._id}')">Apply</button>` :
                                        '<span class="status-badge status-rejected">Full</span>'
                                    )
                                }
                            </div>
                        `;
                        projectsDiv.appendChild(projectDiv);
                    });
                }

                // Show my applications
                const appsDiv = document.getElementById('myApplications');
                if (applications.length === 0) {
                    appsDiv.innerHTML = '<p>You haven\'t applied to any projects yet.</p>';
                } else {
                    appsDiv.innerHTML = '';
                    applications.forEach(app => {
                        const appDiv = document.createElement('div');
                        appDiv.className = 'application-card';
                        appDiv.innerHTML = `
                            <h4>${app.project ? app.project.title : 'Unknown Project'}</h4>
                            <p><strong>Status:</strong> <span class="status-badge status-${app.status}">${app.status}</span></p>
                            <p><strong>Applied:</strong> ${new Date(app.appliedAt).toLocaleDateString()}</p>
                        `;
                        appsDiv.appendChild(appDiv);
                    });
                }
            } catch (error) {
                console.error('Error loading student dashboard:', error);
            }
        }

        async function applyToProject(projectId) {
            try {
                await apiCall('/api/applications', {
                    method: 'POST',
                    body: JSON.stringify({ projectId })
                });
                
                alert('Application submitted successfully!');
                loadStudentDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // Faculty Dashboard
        async function loadFacultyDashboard() {
            try {
                const [projects, applications, reviewProjects] = await Promise.all([
                    apiCall('/api/projects/my'),
                    apiCall('/api/applications/faculty'),
                    apiCall('/api/projects/review')
                ]);

                const approved = projects.filter(p => p.status === 'approved').length;
                const pending = projects.filter(p => p.status === 'pending').length;

                document.getElementById('myProjectsCount').textContent = projects.length;
                document.getElementById('approvedCount').textContent = approved;
                document.getElementById('pendingCount').textContent = pending;
                document.getElementById('reviewCount').textContent = reviewProjects.length;

                // Show faculty projects
                const projectsDiv = document.getElementById('facultyProjects');
                if (projects.length === 0) {
                    projectsDiv.innerHTML = '<p>No projects created yet.</p>';
                } else {
                    projectsDiv.innerHTML = '';
                    projects.forEach(project => {
                        const projectDiv = document.createElement('div');
                        projectDiv.className = 'project-card';
                        let rejectionComments = '';
                        if (project.rejectionComments && project.rejectionComments.length > 0) {
                            rejectionComments = '<div style="margin-top: 15px;"><h5>Review Comments:</h5>';
                            project.rejectionComments.forEach(comment => {
                                rejectionComments += `
                                    <div class="rejection-comment">
                                        <strong>Reviewer:</strong> ${comment.faculty.name}<br>
                                        <strong>Feedback:</strong> ${comment.comment}<br>
                                        <small>Reviewed: ${new Date(comment.reviewedAt).toLocaleDateString()}</small>
                                    </div>
                                `;
                            });
                            rejectionComments += '</div>';
                        }
                        
                        projectDiv.innerHTML = `
                            <h4>${project.title}</h4>
                            <p><strong>Description:</strong> ${project.abstract}</p>
                            <p><strong>Timeline:</strong> ${project.timeline}</p>
                            <p><strong>Seats:</strong> ${project.seatsAvailable}/${project.seats}</p>
                            <p><strong>Status:</strong> <span class="status-badge status-${project.status}">${project.status}</span></p>
                            ${rejectionComments}
                        `;
                        projectsDiv.appendChild(projectDiv);
                    });
                }

                // Show applications
                const appsDiv = document.getElementById('facultyApplications');
                if (applications.length === 0) {
                    appsDiv.innerHTML = '<p>No applications received yet.</p>';
                } else {
                    appsDiv.innerHTML = '';
                    applications.forEach(app => {
                        const appDiv = document.createElement('div');
                        appDiv.className = 'application-card';
                        appDiv.innerHTML = `
                            <h4>Application for: ${app.project.title}</h4>
                            <p><strong>Student:</strong> ${app.student.name} (${app.student.loginId})</p>
                            <p><strong>Status:</strong> <span class="status-badge status-${app.status}">${app.status}</span></p>
                            <p><strong>Applied:</strong> ${new Date(app.appliedAt).toLocaleDateString()}</p>
                            ${app.status === 'pending' ? `
                                <div style="margin-top: 15px;">
                                    <button class="btn btn-success" onclick="selectStudent('${app._id}')">Select</button>
                                    <button class="btn btn-danger" onclick="rejectStudent('${app._id}')">Reject</button>
                                </div>
                            ` : ''}
                        `;
                        appsDiv.appendChild(appDiv);
                    });
                }
            } catch (error) {
                console.error('Error loading faculty dashboard:', error);
            }
        }

        async function selectStudent(appId) {
            try {
                await apiCall(`/api/applications/${appId}/select`, { method: 'POST' });
                alert('Student selected successfully!');
                loadFacultyDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function rejectStudent(appId) {
            try {
                await apiCall(`/api/applications/${appId}/reject`, { method: 'POST' });
                alert('Application rejected!');
                loadFacultyDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        function showNewProjectForm() {
            document.getElementById('newProjectForm').classList.remove('hidden');
            document.getElementById('reviewProjectsSection').classList.add('hidden');
        }

        function hideNewProjectForm() {
            document.getElementById('newProjectForm').classList.add('hidden');
            // Clear form
            document.getElementById('projectTitle').value = '';
            document.getElementById('projectAbstract').value = '';
            document.getElementById('projectTimeline').value = '';
            document.getElementById('projectSeats').value = '';
            updateCharCount();
        }

        async function createProject() {
            const title = document.getElementById('projectTitle').value;
            const abstract = document.getElementById('projectAbstract').value;
            const timeline = document.getElementById('projectTimeline').value;
            const seats = parseInt(document.getElementById('projectSeats').value);

            if (!title || !abstract || !timeline || !seats) {
                alert('Please fill all fields');
                return;
            }

            const wordCount = countWords(abstract);
            if (wordCount > 500) {
                alert('Project description cannot exceed 500 words');
                return;
            }

            try {
                await apiCall('/api/projects', {
                    method: 'POST',
                    body: JSON.stringify({ title, abstract, timeline, seats })
                });

                hideNewProjectForm();
                alert('Project submitted for review successfully!');
                loadFacultyDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function loadReviewProjects() {
            document.getElementById('newProjectForm').classList.add('hidden');
            document.getElementById('reviewProjectsSection').classList.remove('hidden');
            
            try {
                const projects = await apiCall('/api/projects/review');

                const projectsDiv = document.getElementById('reviewProjects');
                if (projects.length === 0) {
                    projectsDiv.innerHTML = '<p>No projects pending your review.</p>';
                } else {
                    projectsDiv.innerHTML = '';
                    projects.forEach(project => {
                        const projectDiv = document.createElement('div');
                        projectDiv.className = 'project-card';
                        projectDiv.innerHTML = `
                            <h4>${project.title}</h4>
                            <p><strong>Faculty:</strong> ${project.faculty.name} (${project.faculty.loginId})</p>
                            <p><strong>Description:</strong> ${project.abstract}</p>
                            <p><strong>Timeline:</strong> ${project.timeline}</p>
                            <p><strong>Seats:</strong> ${project.seats}</p>
                            <p><strong>Submitted:</strong> ${new Date(project.createdAt).toLocaleDateString()}</p>
                            <div style="margin-top: 15px;">
                                <button class="btn btn-success" onclick="approveProject('${project._id}')">Approve</button>
                                <button class="btn btn-danger" onclick="showRejectModal('${project._id}')">Provide Feedback</button>
                            </div>
                        `;
                        projectsDiv.appendChild(projectDiv);
                    });
                }
            } catch (error) {
                console.error('Error loading review projects:', error);
            }
        }

        async function approveProject(projectId) {
            try {
                await apiCall(`/api/projects/${projectId}/approve`, { method: 'POST' });
                alert('Project review submitted successfully!');
                loadReviewProjects();
                loadFacultyDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // Admin Dashboard
        async function loadAdminDashboard() {
            try {
                const users = await apiCall('/api/admin/users');
                
                const students = users.filter(u => u.role === 'student');
                const faculty = users.filter(u => u.role === 'faculty');
                
                document.getElementById('totalStudents').textContent = students.length;
                document.getElementById('totalFaculty').textContent = faculty.length;
                document.getElementById('totalUsers').textContent = users.length;

                // Show users list
                const usersDiv = document.getElementById('usersList');
                if (users.length === 0) {
                    usersDiv.innerHTML = '<p>No users found.</p>';
                } else {
                    usersDiv.innerHTML = '';
                    users.forEach(user => {
                        const userDiv = document.createElement('div');
                        userDiv.className = 'user-card';
                        userDiv.innerHTML = `
                            <h4>${user.name}</h4>
                            <p><strong>Login ID:</strong> ${user.loginId}</p>
                            <p><strong>Role:</strong> ${user.role}</p>
                            <p><strong>Phone:</strong> ${user.phoneNumber}</p>
                            ${user.areaOfResearch ? `<p><strong>Area of Research:</strong> ${user.areaOfResearch}</p>` : ''}
                            <p><strong>Created:</strong> ${new Date(user.createdAt).toLocaleDateString()}</p>
                            <div style="margin-top: 15px;">
                                <button class="btn btn-warning" onclick="resetUser('${user._id}')">Reset Account</button>
                                <button class="btn btn-danger" onclick="deleteUser('${user._id}')">Delete Account</button>
                            </div>
                        `;
                        usersDiv.appendChild(userDiv);
                    });
                }
            } catch (error) {
                console.error('Error loading admin dashboard:', error);
            }
        }

        function showCreateUserForm() {
            document.getElementById('createUserForm').classList.remove('hidden');
        }

        function hideCreateUserForm() {
            document.getElementById('createUserForm').classList.add('hidden');
            // Clear form
            document.getElementById('createLoginId').value = '';
            document.getElementById('createName').value = '';
            document.getElementById('createPhone').value = '';
            document.getElementById('createDOB').value = '';
            document.getElementById('createAreaOfResearch').value = '';
        }

        function toggleUserRole(role) {
            document.querySelectorAll('#createUserForm .role-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            const loginIdLabel = document.getElementById('createLoginIdLabel');
            const dobGroup = document.getElementById('dateOfBirthGroup');
            const researchGroup = document.getElementById('areaOfResearchGroup');
            const loginIdInput = document.getElementById('createLoginId');

            if (role === 'student') {
                loginIdLabel.textContent = 'Registration Number:';
                loginIdInput.placeholder = 'Enter registration number (YYBBBNNNNN)';
                dobGroup.classList.remove('hidden');
                researchGroup.classList.add('hidden');
            } else {
                loginIdLabel.textContent = 'Login ID:';
                loginIdInput.placeholder = 'Enter 6-digit login ID';
                dobGroup.classList.add('hidden');
                researchGroup.classList.remove('hidden');
            }
        }

        async function createUser() {
            const role = document.querySelector('#createUserForm .role-btn.active').dataset.role;
            const loginId = document.getElementById('createLoginId').value;
            const name = document.getElementById('createName').value;
            const phoneNumber = document.getElementById('createPhone').value;
            const dateOfBirth = document.getElementById('createDOB').value;
            const areaOfResearch = document.getElementById('createAreaOfResearch').value;

            if (!loginId || !name || !phoneNumber) {
                showMessage('createUserMessage', 'Please fill all required fields', true);
                return;
            }

            if (role === 'student' && !dateOfBirth) {
                showMessage('createUserMessage', 'Date of birth is required for students', true);
                return;
            }

            if (role === 'faculty' && !areaOfResearch) {
                showMessage('createUserMessage', 'Area of research is required for faculty', true);
                return;
            }

            try {
                const response = await apiCall('/api/admin/create-user', {
                    method: 'POST',
                    body: JSON.stringify({ loginId, name, phoneNumber, role, areaOfResearch, dateOfBirth })
                });

                showMessage('createUserMessage', `User created successfully! Default password: ${response.user.defaultPassword}`);
                setTimeout(() => {
                    hideCreateUserForm();
                    loadAdminDashboard();
                }, 3000);
            } catch (error) {
                showMessage('createUserMessage', error.message, true);
            }
        }

        async function deleteUser(userId) {
            if (!confirm('Are you sure you want to delete this user? This action cannot be undone.')) {
                return;
            }

            try {
                await apiCall(`/api/admin/user/${userId}`, { method: 'DELETE' });
                alert('User deleted successfully');
                loadAdminDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function resetUser(userId) {
            if (!confirm('Are you sure you want to reset this user? All their data will be cleared.')) {
                return;
            }

            try {
                await apiCall(`/api/admin/reset-user/${userId}`, { method: 'POST' });
                alert('User account reset successfully');
                loadAdminDashboard();
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Role button event listeners for login
            document.querySelectorAll('#loginSection .role-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('#loginSection .role-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    const role = this.dataset.role;
                    const loginIdLabel = document.getElementById('loginIdLabel');
                    const loginIdInput = document.getElementById('loginId');
                    
                    if (role === 'student') {
                        loginIdLabel.textContent = 'Registration Number:';
                        loginIdInput.placeholder = 'Enter registration number';
                    } else if (role === 'faculty') {
                        loginIdLabel.textContent = 'Login ID:';
                        loginIdInput.placeholder = 'Enter login ID';
                    } else {
                        loginIdLabel.textContent = 'Admin ID:';
                        loginIdInput.placeholder = 'Enter admin ID';
                    }
                });
            });

            // Check if user is already logged in
            const storedToken = localStorage.getItem('token');
            const storedUser = localStorage.getItem('currentUser');
            
            if (storedToken && storedUser) {
                token = storedToken;
                currentUser = JSON.parse(storedUser);
                
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById(currentUser.role + 'Dashboard').classList.remove('hidden');
                
                if (currentUser.role === 'student') loadStudentDashboard();
                else if (currentUser.role === 'faculty') loadFacultyDashboard();
                else if (currentUser.role === 'admin') loadAdminDashboard();
            }
        });
    </script>
</body>
</html><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Exhibition Portal</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .login-section, .dashboard {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .role-selector {
            display: flex;
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .role-btn {
            flex: 1;
            padding: 15px;
            border: none;
            background: #f8f9fa;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .role-btn.active {
            background: #3498db;
            color: white;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .char-counter {
            font-size: 12px;
            color: #666;
            text-align: right;
            margin-top: 5px;
        }
        
        .char-counter.exceeded {
            color: #e74c3c;
        }
        
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            margin-right: 10px;
        }
        
        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #27ae60;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .btn-danger {
            background: #e74c3c;
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .btn-warning {
            background: #f39c12;
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .project-card, .application-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
            transition: all 0.3s;
        }
        
        .project-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .status-approved {
            background: #d4edda;
            color: #155724;
        }
        
        .status-rejected {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status-selected {
            background: #d4edda;
            color: #155724;
        }
        
        .hidden {
            display: none;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .actions {
            margin-bottom: 30px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .error-message {
            color: #e74c3c;
            text-align: center;
            padding: 15px;
            background: #f8d7da;
            border-radius: 8px;
            margin: 10px 0;
        }

        .success-message {
            color: #155724;
            text-align: center;
            padding: 15px;
            background: #d4edda;
            border-radius: 8px;
            margin: 10px 0;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }

        .rejection-comment {
            background: #f8d7da;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }

        .user-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #17a2b8;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Project Exhibition Portal</h1>
            <p>Connect Faculty and Students for Academic Projects</p>
        </div>

        <!-- Login Section -->
        <div id="loginSection" class="login-section">
            <h2>Login to Your Account</h2>
            <div id="loginMessage"></div>
            <div class="role-selector">
                <button class="role-btn active" data-role="student">Student</button>
                <button class="role-btn" data-role="faculty">Faculty</button>
                <button class="role-btn" data-role="admin">Admin</button>
            </div>
            <div class="form-group">
                <label id="loginIdLabel">Registration Number:</label>
                <input type="text" id="loginId" placeholder="Enter registration number">
            </div>
            <div class="form-group">
                <label>Password:</label>
                <input type="password" id="password" placeholder="Enter password">
            </div>
            <button class="btn" onclick="login()">Login</button>
            <button class="btn" onclick="initDemo()">Initialize Demo Data</button>
            
            <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                <h4>Demo Accounts:</h4>
                <p><strong>Faculty:</strong> FAC001 / CompDr.</p>
                <p><strong>Student:</strong> 24CSE12345 / 01-01-00</p>
                <p><strong>Admin:</strong> admin123 / admin123</p>
            </div>
        </div>

        <!-- Password Change Modal -->
        <div id="passwordModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closePasswordModal()">&times;</span>
                <h3>Change Password Required</h3>
                <div id="passwordModalMessage"></div>
                <div class="form-group">
                    <label>Current Password:</label>
                    <input type="password" id="currentPassword" placeholder="Enter current password">
                </div>
                <div class="form-group">
                    <label>New Password:</label>
                    <input type="password" id="newPassword" placeholder="Enter new password">
                </div>
                <div class="form-group">
                    <label>Confirm New Password:</label>
                    <input type="password" id="confirmPassword" placeholder="Confirm new password">
                </div>
                <button class="btn btn-success" onclick="changePassword()">Change Password</button>
            </div>
        </div>

        <!-- Student Dashboard -->
        <div id="studentDashboard" class="dashboard hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2>Student Dashboard</h2>
                <div>
                    <button class="btn btn-warning" onclick="showPasswordModal()">Change Password</button>
                    <button class="btn btn-danger" onclick="logout()">Logout</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="studentAppsCount">0</div>
                    <div>My Applications</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="availableProjectsCount">0</div>
                    <div>Available Projects</div>
                </div>
            </div>

            <h3>Available Projects</h3>
            <div id="availableProjects"></div>

            <h3>My Applications</h3>
            <div id="myApplications"></div>
        </div>

        <!-- Faculty Dashboard -->
        <div id="facultyDashboard" class="dashboard hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2>Faculty Dashboard</h2>
                <div>
                    <button class="btn btn-warning" onclick="showPasswordModal()">Change Password</button>
                    <button class="btn btn-danger" onclick="logout()">Logout</button>
                </div>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="myProjectsCount">0</div>
                    <div>My Projects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="approvedCount">0</div>
                    <div>Approved</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="pendingCount">0</div>
                    <div>Pending Review</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="reviewCount">0</div>
                    <div>To Review</div>
                </div>
            </div>

            <div class="actions">
                <button class="btn" onclick="showNewProjectForm()">Propose Project</button>
                <button class="btn" onclick="loadReviewProjects()">Review Projects</button>
            </div>

            <!-- New Project Form -->
            <div id="newProjectForm" class="hidden">
                <h3>Propose New Project</h3>
                <div class="form-group">
                    <label>Title:</label>
                    <input type="text" id="projectTitle" placeholder="Project title">
                </div>
                <div class="form-group">
                    <label>Project Description (Max 500 words):</label>
                    <textarea id="projectAbstract" placeholder="Project description" rows="6" maxlength="2500" oninput="updateCharCount()"></textarea>
                    <div id="charCount" class="char-counter">0 / 500 words</div>
                </div>
                <div class="form-group">
                    <label>Timeline:</label>
                    <input type="text" id="projectTimeline" placeholder="e.g., 6 months">
                </div>
                <div class="form-group">
                    <label>Available Seats:</label>
                    <input type="number" id="projectSeats" min="1" placeholder="Number of students">
                </div>
                <button class="btn btn-success" onclick="createProject()">Submit for Review</button>
                <button class="btn" onclick="hideNewProjectForm()">Cancel</button>
            </div>

            <!-- Review Projects Section -->
            <div id="reviewProjectsSection" class="hidden">
                <h3>Projects for Review</h3>
                <div id="reviewProjects"></div>
            </div>

            <h3>My Projects</h3>
            <div id="facultyProjects"></div>

            <h3>Student Applications</h3>
            <div id="facultyApplications"></div>
        </div>

        <!-- Admin Dashboard -->
        <div id="adminDashboard" class="dashboard hidden">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                <h2>Admin Dashboard</h2>
                <button class="btn btn-danger" onclick="logout()">Logout</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="totalStudents">0</div>
                    <div>Total Students</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalFaculty">0</div>
                    <div>Total Faculty</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="totalUsers">0</div>
                    <div>Total Users</div>
                </div>
            </div>

            <div class="actions">
                <button class="btn" onclick="showCreateUserForm()">Create New User</button>
            </div>

            <!-- Create User Form -->
            <div id="createUserForm" class="hidden">
                <h3>Create New User Account</h3>
                <div id="createUserMessage"></div>
                <div class="role-selector">
                    <button class="role-btn active" data-role="student" onclick="toggleUserRole('student')">Student</button>
                    <button class="role-btn" data-role="faculty" onclick="toggleUserRole('faculty')">Faculty</button>
                </div>
                
                <div class="two-column">
                    <div>
                        <div class="form-group">
                            <label id="createLoginIdLabel">Registration Number:</label>
                            <input type="text" id="createLoginId" placeholder="Enter registration number">
                            <small>Format: YYBBBNNNNN (e.g., 24BCE10076)</small>
                        </div>
                        <div class="form-group">
                            <label>Full Name:</label>
                            <input type="text" id="createName" placeholder="Enter full name">
                        </div>
                        <div class="form-group">
                            <label>Phone Number:</label>
                            <input type="text" id="createPhone" placeholder="Enter phone number">
                        </div>
                    </div>
                    <div>
                        <div class="form-group" id="dateOfBirthGroup">
                            <label>Date of Birth:</label>
                            <input type="date" id="createDOB">
                        </div>
                        <div class="form-group hidden" id="areaOfResearchGroup">
                            <label>Area of Research:</label>
                            <input type="text" id="createAreaOfResearch" placeholder="Enter area of research">
                        </div>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="createUser()">Create User</button>
                <button class="btn" onclick="hideCreateUserForm()">Cancel</button>
            </div>

            <h3>User Management</h3>
            <div id="usersList"></div>
        </div>

        <!-- Rejection Comment Modal -->
        <div id="rejectModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeRejectModal()">&times;</span>
                <h3>Project Review - Provide Feedback</h3>
                <div id="rejectModalMessage"></div>
                <div class="form-group">
                    <label>Feedback Comment (Required - Max 500 words):</label>
                    <textarea id="rejectComment" placeholder="Please provide detailed feedback for improvement..." rows="6" maxlength="2500" oninput="updateRejectCharCount()"></textarea>
                    <div id="rejectCharCount" class="char-counter">0 / 500 words</div>
                </div>
                <button class="btn btn-danger" onclick="submitRejection()">Submit Review</button>
                <button class="btn" onclick="closeRejectModal()">Cancel</button>
            </div>
        </div>
    </div>
